char data;
int LM1 = 4, LM2 = 5;
int RM1 = 6, RM2 = 7;
int CUTTING_MOTOR = 13;  // Cutting motor pin

void setup() {
  Serial.begin(9600);
  pinMode(LM1, OUTPUT);
  pinMode(LM2, OUTPUT);
  pinMode(RM1, OUTPUT);
  pinMode(RM2, OUTPUT);
  pinMode(CUTTING_MOTOR, OUTPUT);
  
  stopMotors(); // Start with motors off
  digitalWrite(CUTTING_MOTOR, LOW); // Cutting motor off initially
}

void loop() {
  if (Serial.available() > 0) {
    data = Serial.read();
    Serial.println(data);
    switch (data) {
      case 'F': moveForward(); break;
      case 'B': moveBackward(); break;
      case 'L': turnLeft(); break;
      case 'R': turnRight(); break;
      case 'S': stopMotors(); break;
      case 'X': toggleCuttingMotor(); break;  // Toggle cutting motor
      case 'W': toggleCuttingMotor(); break;  // Triangle button (alternate command)
    }
  }
}

void moveForward() {
  digitalWrite(LM1, HIGH); digitalWrite(LM2, LOW);
  digitalWrite(RM1, HIGH); digitalWrite(RM2, LOW);
  Serial.println("moving forward");
}

void moveBackward() {
  digitalWrite(LM1, LOW); digitalWrite(LM2, HIGH);
  digitalWrite(RM1, LOW); digitalWrite(RM2, HIGH);
}

void turnLeft() {
  digitalWrite(LM1, LOW); digitalWrite(LM2, HIGH);  // Left motor backward
  digitalWrite(RM1, HIGH); digitalWrite(RM2, LOW);  // Right motor forward
}

void turnRight() {
  digitalWrite(LM1, HIGH); digitalWrite(LM2, LOW);  // Left motor forward
  digitalWrite(RM1, LOW); digitalWrite(RM2, HIGH);  // Right motor backward
}

void stopMotors() {
  digitalWrite(LM1, LOW); digitalWrite(LM2, LOW);
  digitalWrite(RM1, LOW); digitalWrite(RM2, LOW);
}

void toggleCuttingMotor() {
    static bool motorState = false;  // Track motor state
  motorState = !motorState;  // Toggle state
  digitalWrite(CUTTING_MOTOR, motorState ? HIGH : LOW);
  //digitalWrite(CUTTING_MOTOR, HIGH);
  //Serial.println("hello world!!!!++++++++++++++++++++++++");
  moveForward();
}
